import{_ as T}from"./AppLayout.vue_vue_type_script_setup_true_lang-CFOBMdtu.js";import{d as E,j as a,l as R,c as j,o as I,a as r,u as A,m as J,w as z,b as h,g as G,i as K,F as L,v as M}from"./app-D_30lCPY.js";import{_ as Q}from"./SubdealershipsDialog.vue_vue_type_script_setup_true_lang-CEkcm1-v.js";import{_ as W}from"./Alert.vue_vue_type_script_setup_true_lang-B8X9tz52.js";import{_ as X}from"./OtherUnitDialog.vue_vue_type_script_setup_true_lang-DPLOqIj6.js";import{_ as Y}from"./SalesCard.vue_vue_type_script_setup_true_lang-V0c_XEYJ.js";import{_ as Z}from"./SalesHeader.vue_vue_type_script_setup_true_lang-CHd3r-EI.js";import ee from"./SalesTable-BHbGLHrS.js";import"./utils-bRKmu4jq.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-BwyrFf5a.js";import"./Presence-BPVtuLwC.js";import"./Primitive-DPXPT-5q.js";import"./useForwardExpose-DVHaXJa7.js";import"./PopperContent-BtEsArwb.js";import"./Teleport-CWphWnx9.js";import"./VisuallyHidden-CfVhPomW.js";import"./index-dkW4UkYo.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-1-IISxSC.js";import"./utils-Cc_kZu4w.js";import"./useTypeahead-xGntZ5Yj.js";import"./RovingFocusGroup-DCuFZx63.js";import"./usePrimitiveElement-DJdzkk5d.js";import"./Collection-DZ4uY3RW.js";import"./utensils-b2iRzuqA.js";import"./createLucideIcon-yK0qzumI.js";import"./DialogTitle-DzGias3d.js";import"./x-BeqBtXx0.js";import"./DialogDescription-BSM7uzkb.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./hand-helping-DVye06Mx.js";import"./building-2-BVeB84PC.js";import"./user-v9caxZgY.js";import"./chevron-right-BdYwrSSB.js";import"./index-QN4VJNje.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-CKprfftn.js";import"./DialogFooter.vue_vue_type_script_setup_true_lang-ojhWNjwX.js";import"./DialogTrigger.vue_vue_type_script_setup_true_lang-BZnl6OFt.js";import"./Input.vue_vue_type_script_setup_true_lang-CqLR2zgG.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-C0PsXp7m.js";import"./chevron-down-CYZW4T6X.js";import"./chevron-up-Df9oSPJx.js";import"./check-Ls2929Rn.js";import"./SelectLabel.vue_vue_type_script_setup_true_lang-DKUW7Bjn.js";import"./circle-plus-uTsaTdZL.js";import"./index-GMj406To.js";import"./Card.vue_vue_type_script_setup_true_lang-BPL_UvjB.js";import"./building-DbTLstTk.js";import"./sandwich-BxMj5Noy.js";import"./phone-BZK4F8Yo.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-BzaP3FcA.js";import"./RovingFocusItem-Q44zZbDx.js";import"./DatePicker.vue_vue_type_script_setup_true_lang-BbUnbRvS.js";import"./useCalendar-BuNyE2bD.js";import"./CalendarPrevButton.vue_vue_type_script_setup_true_lang-DVQ91D42.js";import"./chevron-left-BuWlhE3M.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-e4oixoGB.js";import"./calendar-DTbzER9Q.js";import"./DinnersTable.vue_vue_type_script_setup_true_lang-AZWY13kl.js";import"./ExcelDialog.vue_vue_type_script_setup_true_lang-BsC7s8OL.js";import"./sheet-Caru67Ba.js";import"./NewDinnerDialog.vue_vue_type_script_setup_true_lang-Ds9kQLRp.js";import"./user-plus-mRpPUE5U.js";import"./ReportDialog.vue_vue_type_script_setup_true_lang-fTmPeMbv.js";import"./file-chart-column-GHgZ-8IE.js";import"./loader-circle-DDY6uFfm.js";import"./file-qN3D4EIv.js";import"./tag-CDq2D0e1.js";import"./TableHeader.vue_vue_type_script_setup_true_lang-C3A2Ui6i.js";import"./TableCaption.vue_vue_type_script_setup_true_lang-CotdJcr9.js";import"./SaleDetailsPopover.vue_vue_type_script_setup_true_lang-D7aE7gNE.js";import"./between-horizontal-start-BMFDnqIJ.js";const te={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},ae={class:"grid auto-rows-min gap-4 md:grid-cols-2"},Dt=E({__name:"Index",props:{dinners:{},services:{},units:{},cafes:{},sale_types:{},receipt_types:{},todaySales:{},subdealerships:{},dealerships:{}},setup(U){const n=a(null),x=R().props.auth.permissions,_=U,i=a([]),P=e=>i.value.some(t=>t.serviceID===e.id),$=e=>{if(P(e)){i.value=i.value.filter(t=>t.serviceID!==e.id);return}i.value.push({serviceID:e.id,quantity:e.quantity||1,price:e.quantity*e.pivot.price,code:e.code,name:e.name,unit_price:e.pivot.price,service_type:e.type})},k=(e,t)=>{N.value=e,d.value=t},d=a([..._.todaySales.data]),N=a([]),S=a(!1),y=a(""),g=a(""),l=a(""),m=a(!1),c=a(!1),p=(e,t)=>{var o;y.value=((o=t.response)==null?void 0:o.data.message)||t||"Ha ocurrido un error inesperado.",g.value=e,S.value=!0},u=a(""),D=()=>{m.value=!0},V=()=>{m.value=!1,c.value=!1},B=e=>{l.value=e},H=e=>{if(!e.trim()||e.length!=8){alert("Por favor, ingrese un DNI válido.");return}else f(e)},v=a(0),w=a(0),b=a(0),O=e=>{v.value=e.cafe_id,w.value=e.sale_type_id,b.value=e.receipt_type_id},q=e=>{c.value=!0,f(u.value)},F=a({}),C=a({}),f=e=>{u.value=e;const t=new FormData;if(t.append("cafe_id",v.value),t.append("sale_type_id",w.value),t.append("receipt_type",b.value),t.append("services",JSON.stringify(i.value)),t.append("dni",e),t.append("date",l.value),t.append("double_price",c.value),l.value==null||l.value==""){p("error","Por favor, seleccione una fecha válida.");return}M.post("./sales",t).then(o=>{var s;o.data.dinner&&(F.value=o.data.dinner,C.value=o.data.dinner.subdealership,p("success",o.data.message||"Venta registrada exitosamente."),(s=n.value)==null||s.cleanInput(),d.value=o.data.sales||[]),o.data.otherCafe&&(console.log(u.value),D())}).catch(o=>{var s;console.error("Error fetching dinners:",o),p("error",o),(s=n.value)==null||s.cleanInput()})};return(e,t)=>(I(),j(L,null,[r(A(J),{title:"Comensales"}),r(T,null,{default:z(()=>[r(W,{showAlert:S.value,type:g.value,description:y.value},null,8,["showAlert","type","description"]),h("div",te,[t[0]||(t[0]=h("h2",{class:"text-center text-2xl font-semibold"},"Punto de Venta",-1)),A(x).find(o=>o.id==14)?(I(),G(Q,{key:0,dealerships:e.dealerships},null,8,["dealerships"])):K("",!0),r(Z,{units:e.units,cafes:e.cafes,subdealerships:e.subdealerships,services:e.services,receipt_types:e.receipt_types,sale_types:e.sale_types,onShowServicesFromCafeSelected:k,onUpdateDate:B,onUpdateFormData:O,onAddServiceSelected:$},null,8,["units","cafes","subdealerships","services","receipt_types","sale_types"]),h("div",ae,[r(Y,{dinnerFound:F.value,subdealership:C.value,onHandleShowAlert:p,onShowDialog:D,onSaveSale:f,onUpdateDni:H,ref_key:"salesCardRef",ref:n},null,8,["dinnerFound","subdealership"]),r(ee,{sales:d.value,paginateData:_.todaySales,cafeId:v.value},null,8,["sales","paginateData","cafeId"]),r(X,{showOtherUnitDialog:m.value,onHideDialog:V,onHandleDoublePriceSave:q},null,8,["showOtherUnitDialog"])])])]),_:1})],64))}});export{Dt as default};
