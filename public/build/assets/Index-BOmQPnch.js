import{_ as J}from"./AppLayout.vue_vue_type_script_setup_true_lang-_WVNti4i.js";import{d as L,r as a,k as M,s as G,y as K,c as Q,o as U,a as r,u as c,m as W,w as x,b as s,e as V,g as X,i as Y,t as b,F as Z,z as ee}from"./app-D-LqQbZa.js";import{_ as te}from"./SubdealershipsDialog.vue_vue_type_script_setup_true_lang-RRCL_r38.js";import{_ as se}from"./Alert.vue_vue_type_script_setup_true_lang-B4bFopCq.js";import{_ as oe}from"./OtherUnitDialog.vue_vue_type_script_setup_true_lang-Ohjvpocp.js";import ae from"./SalesCard-B_lxpXz1.js";import ie from"./SalesHeader-Cx1wzj4y.js";import{_ as re}from"./SalesTable.vue_vue_type_script_setup_true_lang-HlURzxtk.js";import{_ as le}from"./Icon.vue_vue_type_script_setup_true_lang-gEMWzwnX.js";import{_ as ne}from"./Card.vue_vue_type_script_setup_true_lang-DP9HkVF3.js";import{S as pe}from"./shopping-cart-BlNgnin8.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./utils-bRKmu4jq.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-DIcxem_I.js";import"./Presence-5rM4SnOx.js";import"./Primitive-D2E4zh-F.js";import"./useForwardExpose-C0s566w4.js";import"./PopperContent-BmDe8RlA.js";import"./Teleport-C90D5m2n.js";import"./VisuallyHidden-BMVg-pqG.js";import"./index-dkW4UkYo.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-ChRH62iI.js";import"./utils-DrB2bsOv.js";import"./useTypeahead-D3motRUW.js";import"./RovingFocusGroup-D3Tsaytf.js";import"./usePrimitiveElement-EZ5wwPph.js";import"./Collection-D9d2Sq_a.js";import"./utensils-BSk9kXbm.js";import"./createLucideIcon-Ds2iLTpM.js";import"./DialogTitle-CIiJ2IkS.js";import"./x-b92faefF.js";import"./DialogDescription-zqXnhQK4.js";import"./hand-helping-B2OrTdtM.js";import"./building-2-BVTNxSIJ.js";import"./user-Cwyi-5P7.js";import"./chevron-right-Cq55BZVf.js";import"./index-DpgMMlKQ.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-DwCCe1VU.js";import"./DialogFooter.vue_vue_type_script_setup_true_lang-B0NV6Kd9.js";import"./DialogTrigger.vue_vue_type_script_setup_true_lang-D0htdjR-.js";import"./Input.vue_vue_type_script_setup_true_lang-B6C72Mwn.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-CToYXGco.js";import"./chevron-down-CLUrzGV_.js";import"./chevron-up-a8bJVb19.js";import"./check-DoDSKdKK.js";import"./useFormControl-CdIo0Tlf.js";import"./SelectGroup.vue_vue_type_script_setup_true_lang-CaFyVKcA.js";import"./SelectLabel.vue_vue_type_script_setup_true_lang-B_cwvzXX.js";import"./circle-plus-DkW3G8dO.js";import"./index-DWxuIRGj.js";import"./CardContent.vue_vue_type_script_setup_true_lang-Dp6epoJN.js";import"./index-DaIYS-Aw.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-C-N8GeW7.js";import"./RovingFocusItem-1ihwZVcP.js";import"./DatePicker.vue_vue_type_script_setup_true_lang-1N_0uFB-.js";import"./useCalendar-C5HpWjlH.js";import"./CalendarPrevButton.vue_vue_type_script_setup_true_lang-DwiOAwhX.js";import"./chevron-left-qEn28Xtk.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-wUrEfUnv.js";import"./calendar-CWgTl_K1.js";import"./DinnersTable.vue_vue_type_script_setup_true_lang-C_PP3q1K.js";import"./ReportDialog.vue_vue_type_script_setup_true_lang-CRWf0cjS.js";import"./file-chart-column-BNBba-8G.js";import"./loader-circle-DpQTt_Uh.js";import"./TableHeader.vue_vue_type_script_setup_true_lang-ByUdf-Hj.js";import"./SaleDetailsPopover.vue_vue_type_script_setup_true_lang-D2e5kusa.js";import"./between-horizontal-start-xyVwXBMu.js";import"./settings-2-B1OirUe9.js";import"./briefcase-Xmtl9DiM.js";import"./lock-VA-0N1cL.js";import"./shopping-bag-DFapWeEq.js";import"./zap-BNzybbBh.js";import"./user-round-CISTvNYs.js";import"./person-standing-COxu-rZm.js";import"./scale-CZ8pgDg-.js";import"./paperclip-CyL3-0Wt.js";import"./circle-alert-52ZMIOm6.js";import"./triangle-alert-BPPxmAm6.js";import"./circle-check-VP-ZzmRA.js";import"./shirt-D5iYOZ7I.js";import"./copy-BNuVN1l6.js";import"./dollar-sign-pfe3naiy.js";import"./message-square-lUeyvym4.js";import"./eye-mSdyq9CV.js";import"./file-BvbRlJBE.js";import"./info-CA5ot4fU.js";import"./lamp-desk-BC4R8tFo.js";import"./list-check-CEU2RqGa.js";import"./sheet-CTwanoGL.js";import"./mail-DnloGrzi.js";import"./monitor-CAzvVKRW.js";import"./sun-viAVOpRf.js";import"./package-plus-BAuL2zDf.js";import"./package-CR6_iB-i.js";import"./pencil-Bs-09YM6.js";import"./phone-DvDUiVmq.js";import"./plus-D4e7NBze.js";import"./search-B5XbEvtW.js";import"./shield-CoKnK0eR.js";import"./soup-C33LeQjk.js";import"./trash-2-BCJ-1ccr.js";import"./trash-BvV3zZaY.js";import"./truck-B8h0KZmM.js";import"./upload-BciA0lU5.js";import"./user-plus-giM89TS3.js";const ce={class:"p-4 md:p-8 space-y-6 bg-slate-50/50 min-h-screen"},me={class:"flex flex-col md:flex-row justify-between items-start md:items-center gap-6"},ue={class:"flex items-center gap-4"},fe={class:"h-14 w-14 rounded-2xl bg-primary flex items-center justify-center text-primary-foreground shadow-lg shadow-primary/20 rotate-3"},ve={class:"flex items-center gap-4"},_e={class:"flex flex-col items-end"},he={class:"text-2xl font-black text-slate-700 leading-none"},ge={class:"flex flex-col items-end"},Se={class:"text-2xl font-black text-primary leading-none"},ye={class:"grid grid-cols-1 xl:grid-cols-12 gap-6"},xe={class:"xl:col-span-4 space-y-6"},be={class:"xl:col-span-8 space-y-6"},we={class:"grid grid-cols-1 gap-6"},De={class:"bg-white rounded-2xl shadow-sm border border-slate-200/60 overflow-hidden"},Ce={class:"p-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/50"},Fe={class:"flex items-center gap-2"},ke=L({__name:"Index",props:{dinners:{},services:{},units:{},cafes:{},sale_types:{},receipt_types:{},todaySales:{},subdealerships:{},dealerships:{}},setup($){var T;const m=a(null),B=M().props.auth.permissions,u=$,l=a([]),N=e=>l.value.some(t=>t.serviceID===e.id),P=e=>{var t,o;if(N(e)){l.value=l.value.filter(i=>i.serviceID!==e.id);return}l.value.push({serviceID:e.id,quantity:e.quantity||1,price:(e.quantity||1)*(((t=e.pivot)==null?void 0:t.price)||0),code:e.code,name:e.name,unit_price:((o=e.pivot)==null?void 0:o.price)||0,service_type:e.type})},H=(e,t)=>{w.value=e;const o=u.todaySales.data.filter(i=>i.cafe_id==t);n.value=o},n=a([...((T=u.todaySales)==null?void 0:T.data)||[]]),w=a([]),f=a(!1),D=a(""),C=a(""),v=a(""),_=a(!1),h=a(!1),p=(e,t)=>{var o;D.value=((o=t.response)==null?void 0:o.data.message)||t||"Ha ocurrido un error inesperado.",C.value=e,f.value=!0},F=a(""),k=()=>{_.value=!0},O=()=>{_.value=!1,h.value=!1},R=e=>{v.value=e},j=e=>{if(!e.trim()||e.length!=8){p("error","Por favor, ingrese un DNI válido (8 dígitos).");return}y(e)},d=a(0),g=a(0),S=a(0),q=e=>{d.value=e.cafe_id,g.value=e.sale_type_id,S.value=e.receipt_type_id},E=e=>{h.value=!0,y(F.value)},I=a({}),A=a({}),y=e=>{F.value=e;const t=new FormData;if(t.append("cafe_id",d.value.toString()),t.append("sale_type_id",g.value.toString()),t.append("receipt_type",S.value.toString()),t.append("services",JSON.stringify(l.value)),t.append("dni",e.toString()),t.append("date",v.value),t.append("double_price",h.value.toString()),!v.value){p("error","Por favor, seleccione una fecha válida.");return}if(l.value.length===0){p("error","Debe seleccionar al menos un servicio.");return}ee.post("/sales",t).then(o=>{var i;o.data.dinner&&(I.value=o.data.dinner,A.value=o.data.dinner.subdealership,p("success",o.data.message||"Venta registrada exitosamente."),(i=m.value)==null||i.cleanInput(),n.value=o.data.sales||[]),o.data.otherCafe&&k()}).catch(o=>{var i;console.error("Error recording sale:",o),p("error",o),(i=m.value)==null||i.cleanInput()})},z=G(()=>n.value.reduce((e,t)=>e+parseFloat(t.total||0),0));return(e,t)=>{const o=K("Badge");return U(),Q(Z,null,[r(c(W),{title:"Punto de Venta - COMENSALS"}),r(J,null,{default:x(()=>[r(se,{showAlert:f.value,type:C.value,description:D.value,onClose:t[0]||(t[0]=i=>f.value=!1)},null,8,["showAlert","type","description"]),s("div",ce,[s("div",me,[s("div",ue,[s("div",fe,[r(c(pe))]),t[1]||(t[1]=s("div",null,[s("h1",{class:"text-3xl font-extrabold tracking-tight text-slate-900 uppercase"},"Punto de Venta"),s("p",{class:"text-slate-500 font-medium text-sm flex items-center gap-2"},[s("span",{class:"flex h-2 w-2 rounded-full bg-emerald-500 animate-pulse"}),V(" Sistema de Registro de Servicios en Tiempo Real ")])],-1))]),s("div",ve,[r(c(ne),{class:"bg-white border-none shadow-sm h-16 flex items-center px-6 py-3 gap-8"},{default:x(()=>[s("div",_e,[t[2]||(t[2]=s("span",{class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest leading-none mb-1"},"Atendidos",-1)),s("span",he,b(n.value.length),1)]),t[4]||(t[4]=s("div",{class:"w-px h-8 bg-slate-100"},null,-1)),s("div",ge,[t[3]||(t[3]=s("span",{class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest leading-none mb-1"},"Total de Hoy",-1)),s("span",Se,"S/ "+b(z.value.toFixed(2)),1)])]),_:1}),c(B).find(i=>i.id==14)?(U(),X(te,{key:0,dealerships:e.dealerships},null,8,["dealerships"])):Y("",!0)])]),s("div",ye,[s("div",xe,[r(ie,{units:e.units,cafes:e.cafes,subdealerships:e.subdealerships,services:e.services,receipt_types:e.receipt_types,sale_types:e.sale_types,onShowServicesFromCafeSelected:H,onUpdateDate:R,onUpdateFormData:q,onAddServiceSelected:P},null,8,["units","cafes","subdealerships","services","receipt_types","sale_types"])]),s("div",be,[s("div",we,[r(ae,{dinnerFound:I.value,subdealership:A.value,servicesSelectedToSale:l.value,services:w.value,cafeSelected:d.value,saletypeSelected:g.value,receiptType:S.value,onHandleShowAlert:p,onShowDialog:k,onSaveSale:y,onUpdateDni:j,ref_key:"salesCardRef",ref:m},null,8,["dinnerFound","subdealership","servicesSelectedToSale","services","cafeSelected","saletypeSelected","receiptType"]),s("div",De,[s("div",Ce,[s("div",Fe,[r(le,{name:"history",class:"text-slate-400"}),t[5]||(t[5]=s("h3",{class:"font-bold text-slate-700"},"Ventas Recientes",-1))]),r(o,{variant:"outline",class:"bg-white font-bold text-xs"},{default:x(()=>[V(b(n.value.length)+" registros",1)]),_:1})]),r(re,{sales:n.value,paginateData:u.todaySales,cafeId:d.value},null,8,["sales","paginateData","cafeId"])])])])]),r(oe,{showOtherUnitDialog:_.value,onHideDialog:O,onHandleDoublePriceSave:E},null,8,["showOtherUnitDialog"])])]),_:1})],64)}}}),Fs=de(ke,[["__scopeId","data-v-a02fae0e"]]);export{Fs as default};
