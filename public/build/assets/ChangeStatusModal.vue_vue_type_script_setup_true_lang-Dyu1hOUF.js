import{d as V,l as D,j,C as B,g as P,o as r,w as l,a as i,u as o,b as t,e as g,t as n,D as _,c as d,i as b,F as y,p as w,bP as H,bQ as I,n as L}from"./app-D1TBsDKU.js";import{_ as v}from"./index-BU5NN4gF.js";import{_ as M,a as O,b as R,c as U}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BDavC9JJ.js";import{_ as z}from"./DialogFooter.vue_vue_type_script_setup_true_lang-DXUUZZeO.js";import{_ as F}from"./DialogTrigger.vue_vue_type_script_setup_true_lang-iptsNR8o.js";import{I as G}from"./info-D7TWHbNu.js";const T={class:"flex-shrink-0 space-y-4 py-4"},q={class:"space-y-2"},A={class:"text-sm text-gray-600"},Q={class:"space-y-2"},J=["value"],K={key:0,class:"text-sm text-red-600"},W={class:"space-y-2"},X={key:0,class:"text-sm text-red-600"},Y={class:"min-h-0 flex-1 border-t pt-4"},Z={class:"max-h-[300px] overflow-y-auto pr-2"},ss={key:0,class:"relative"},ts={class:"text-xs font-bold text-white"},es={class:"rounded-lg bg-gray-50 p-3 shadow-sm"},os={class:"mb-1 flex items-start justify-between"},as={class:"text-sm font-medium"},rs={class:"text-xs text-gray-500"},ns={key:0,class:"mt-1 text-sm text-gray-700"},ls={key:1,class:"mt-2 text-xs text-gray-500"},is={key:1,class:"py-8 text-center text-sm text-gray-500"},ps=V({__name:"ChangeStatusModal",props:{staff:{type:Object,required:!0}},emits:["save","update:open"],setup(u,{emit:C}){var x;const p=u,h=D(),k=C,f=j(!1),S={0:"Lista negra",1:"En proceso",2:"Completo - RRHH",3:"Contratado",4:"Cesado",5:"Retirado",6:"Abandono",7:"Cumplió Contrato"},a=B({staff_id:p.staff.id,status:p.staff.status,observation:"",user_id:(x=h.props.auth.user)==null?void 0:x.id}),$=()=>{a.post(route("staff.update-status"),{onSuccess:()=>{k("save"),a.reset(),a.status=p.staff.status,f.value=!1}})},E=m=>new Date(m).toLocaleString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),N=m=>({0:"bg-red-500",1:"bg-yellow-500",2:"En proceso",3:"bg-green-500",4:"bg-gray-500",5:"bg-blue-500",6:"bg-orange-500",7:"bg-purple-500"})[m]||"bg-gray-500";return(m,s)=>(r(),P(o(U),{open:f.value,"onUpdate:open":s[3]||(s[3]=e=>f.value=e)},{default:l(()=>[i(o(F),{"as-child":""},{default:l(()=>[i(v,{variant:"ghost",size:"icon",class:"cursor-pointer text-green-600 hover:text-green-800"},{default:l(()=>[i(o(G),{class:"h-4 w-4"})]),_:1})]),_:1}),i(o(M),{class:"flex max-h-[90vh] flex-col sm:max-w-[800px]"},{default:l(()=>[i(o(O),null,{default:l(()=>[i(o(R),null,{default:l(()=>s[4]||(s[4]=[g("Cambiar Estado del Personal")])),_:1})]),_:1}),t("div",T,[t("div",q,[s[5]||(s[5]=t("label",{class:"text-sm font-medium"},"Personal",-1)),t("p",A,n(u.staff.name),1)]),t("div",Q,[s[6]||(s[6]=t("label",{for:"status",class:"text-sm font-medium"},"Nuevo Estado",-1)),_(t("select",{id:"status","onUpdate:modelValue":s[0]||(s[0]=e=>o(a).status=e),class:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 focus:outline-none"},[(r(),d(y,null,w(S,(e,c)=>t("option",{key:c,value:c},n(e),9,J)),64))],512),[[H,o(a).status]]),o(a).errors.status?(r(),d("p",K,n(o(a).errors.status),1)):b("",!0)]),t("div",W,[s[7]||(s[7]=t("label",{for:"observation",class:"text-sm font-medium"},"Observación",-1)),_(t("textarea",{id:"observation","onUpdate:modelValue":s[1]||(s[1]=e=>o(a).observation=e),rows:"3",placeholder:"Ingrese una observación sobre el cambio de estado...",class:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 focus:outline-none"},null,512),[[I,o(a).observation]]),o(a).errors.observation?(r(),d("p",X,n(o(a).errors.observation),1)):b("",!0)])]),t("div",Y,[s[9]||(s[9]=t("h3",{class:"mb-3 text-sm font-medium"},"Historial de Observaciones",-1)),t("div",Z,[u.staff.observations&&u.staff.observations.length>0?(r(),d("div",ss,[s[8]||(s[8]=t("div",{class:"absolute top-0 bottom-0 left-[15px] w-0.5 bg-gray-200"},null,-1)),(r(!0),d(y,null,w(u.staff.observations,(e,c)=>(r(),d("div",{key:e.id,class:"relative pb-6 pl-10 last:pb-0"},[t("div",{class:L(["absolute top-1 left-0 flex h-8 w-8 items-center justify-center rounded-full border-4 border-white",N(e.status)])},[t("span",ts,n(c+1),1)],2),t("div",es,[t("div",os,[t("span",as,n(e.user.name),1),t("span",rs,n(E(e.created_at)),1)]),e.observation?(r(),d("p",ns,n(e.observation),1)):b("",!0),e.user_name?(r(),d("p",ls,"Por: "+n(e.user_name),1)):b("",!0)])]))),128))])):(r(),d("div",is,"No hay historial de cambios registrado"))])]),i(o(z),null,{default:l(()=>[i(v,{variant:"outline",onClick:s[2]||(s[2]=e=>f.value=!1)},{default:l(()=>s[10]||(s[10]=[g("Cancelar")])),_:1}),i(v,{type:"submit",onClick:$,disabled:o(a).processing},{default:l(()=>[g(n(o(a).processing?"Guardando...":"Guardar"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]))}});export{ps as _};
