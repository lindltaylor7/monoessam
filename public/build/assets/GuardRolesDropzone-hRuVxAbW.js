import{d as D,r as p,b_ as E,G as O,u as h,o as c,c as d,a as V,i as B,b as L,x as T,bQ as F,F as G,l as H,t as I,n as P,Y as S,z as q}from"./app-D-LqQbZa.js";import A from"./Draggable-VySdkG6s.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./x-b92faefF.js";import"./createLucideIcon-Ds2iLTpM.js";var k={exports:{}},R;function $(){return R||(R=1,function(g,b){function v(e){return typeof e.value!="function"?(console.warn("[Vue-click-outside:] provided expression",e.expression,"is not a function."),!1):!0}function a(e,s){if(!e||!s)return!1;for(var t=0,u=s.length;t<u;t++)try{if(e.contains(s[t]))return!0;if(s[t].contains(e))return!1}catch{return!1}return!1}function n(e){return typeof e.componentInstance<"u"&&e.componentInstance.$isServer}g.exports={bind:function(e,s,t){if(!v(s))return;function u(l){if(t.context){var f=l.path||l.composedPath&&l.composedPath();f&&f.length>0&&f.unshift(l.target),!(e.contains(l.target)||a(t.context.popupItem,f))&&e.__vueClickOutside__.callback(l)}}e.__vueClickOutside__={handler:u,callback:s.value};const _="ontouchstart"in document.documentElement?"touchstart":"click";!n(t)&&document.addEventListener(_,u)},update:function(e,s){v(s)&&(e.__vueClickOutside__.callback=s.value)},unbind:function(e,s,t){const u="ontouchstart"in document.documentElement?"touchstart":"click";!n(t)&&e.__vueClickOutside__&&document.removeEventListener(u,e.__vueClickOutside__.handler),delete e.__vueClickOutside__}}}(k)),k.exports}var M=$();const N={key:0},Q={key:1},Y={key:0,class:"relative"},j={key:0,class:"absolute z-10 mt-1 w-full rounded border border-zinc-300 bg-white shadow-lg"},J=["onClick"],W={key:1,class:"p-2 text-sm text-zinc-500"},X=D({__name:"GuardRolesDropzone",props:{role:{},users:{},staff:{}},emits:["roleAssigned","unassignUser"],setup(g,{emit:b}){var y;const v=b,a=g,n=p(null),e=p(!1),s=p(""),t=p([]),u=p(null);console.log(a),(y=a.role)!=null&&y.staff&&(console.log(a),n.value=a.staff);const _=o=>{n.value=null,v("unassignUser",o)},l=o=>{n.value=o,e.value=!1,s.value="",t.value=[],q.post("guards/roles/user",{user_id:o.id,guard_role_id:a.role.id}).then(i=>{v("roleAssigned",o.id)}).catch(i=>{var r;console.error("Error al asignar el rol:",i),n.value=(r=a.role)!=null&&r.user?a.role.user:null})},f=async()=>{if(s.value.length<3){t.value=[];return}const o=a.users;t.value=o.filter(i=>i.name.toLowerCase().includes(s.value.toLowerCase())).slice(0,5)},w=()=>{n.value||(e.value=!0,S(()=>{u.value&&u.value.focus()}))},x=()=>{e.value=!1,s.value="",t.value=[]},z=o=>{l(o)},{elementRef:U,isOvered:C}=E({events:{onDrop:(o,i)=>{var m;const r=(m=i.items[0].data)==null?void 0:m.user;console.log(r),r&&l(r)}}});return(o,i)=>O((c(),d("div",{ref_key:"guardRolesDropzoneRef",ref:U,class:"relative min-h-[6rem] w-full"},[n.value&&n.value.id?(c(),d("div",N,[V(A,{user:n.value,onUnassignUser:_,showButtonDelete:!0},null,8,["user"])])):(c(),d("div",Q,[e.value?(c(),d("div",Y,[O(L("input",{type:"text","onUpdate:modelValue":i[0]||(i[0]=r=>s.value=r),onInput:f,placeholder:"Buscar y asignar usuario...",class:"w-full rounded border border-blue-500 p-2 focus:ring-2 focus:ring-blue-500",onKeyup:T(x,["esc"]),ref_key:"inputRef",ref:u},null,544),[[F,s.value]]),t.value.length?(c(),d("ul",j,[(c(!0),d(G,null,H(t.value,r=>(c(),d("li",{key:r.id,onClick:m=>z(r),class:"cursor-pointer p-2 hover:bg-blue-100"},I(r.name),9,J))),128))])):s.value.length>=3?(c(),d("div",W,"No se encontraron usuarios.")):B("",!0)])):(c(),d("div",{key:1,onClick:w,class:P({"cursor-pointer rounded border-2 border-dashed p-5 transition-colors":!0,"border-zinc-600":!h(C),"border-green-500 bg-green-50 dark:bg-zinc-800":h(C)})}," Haga clic o arrastre para asignar ",2))]))])),[[h(M.ClickOutside),x]])}}),ne=K(X,[["__scopeId","data-v-91013e2c"]]);export{ne as default};
