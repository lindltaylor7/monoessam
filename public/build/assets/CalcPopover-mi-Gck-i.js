import{_ as g}from"./index-DpgMMlKQ.js";import{_ as z}from"./Input.vue_vue_type_script_setup_true_lang-B6C72Mwn.js";import{_ as b}from"./Label.vue_vue_type_script_setup_true_lang-DM9lszr3.js";import{_ as T,a as B,b as W}from"./PopoverTrigger.vue_vue_type_script_setup_true_lang-wUrEfUnv.js";import{_ as I,a as U,b as q,c as A,d as D}from"./SelectValue.vue_vue_type_script_setup_true_lang-CToYXGco.js";import{_ as G}from"./SelectGroup.vue_vue_type_script_setup_true_lang-CaFyVKcA.js";import{_ as E}from"./Separator.vue_vue_type_script_setup_true_lang-B8CLVqH5.js";import{C as P,S as L,F as R}from"./scale-CZ8pgDg-.js";import{T as H}from"./truck-B8h0KZmM.js";import{D as J}from"./dollar-sign-pfe3naiy.js";import{T as K}from"./trash-2-BCJ-1ccr.js";import{d as O,r as d,q as $,g as k,o as w,w as l,a,u as o,b as e,t as r,c as Q,F as X,l as Y,e as c}from"./app-D-LqQbZa.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Primitive-D2E4zh-F.js";import"./utils-bRKmu4jq.js";import"./index-dkW4UkYo.js";import"./useForwardExpose-C0s566w4.js";import"./Presence-5rM4SnOx.js";import"./Teleport-C90D5m2n.js";import"./PopperContent-BmDe8RlA.js";import"./chevron-down-CLUrzGV_.js";import"./createLucideIcon-Ds2iLTpM.js";import"./chevron-up-a8bJVb19.js";import"./Collection-D9d2Sq_a.js";import"./usePrimitiveElement-EZ5wwPph.js";import"./check-DoDSKdKK.js";import"./useTypeahead-D3motRUW.js";import"./utils-DrB2bsOv.js";import"./useFormControl-CdIo0Tlf.js";import"./VisuallyHidden-BMVg-pqG.js";const ee={class:"p-5 bg-gradient-to-r from-zinc-50 to-white border-b border-zinc-100"},te={class:"flex items-center gap-3"},se={class:"p-2 bg-blue-50 rounded-lg"},oe={class:"text-[12px] text-zinc-500 font-medium line-clamp-1"},ae={class:"p-5 space-y-6"},le={class:"space-y-4"},ie={class:"flex items-center gap-2 mb-1"},re={class:"flex flex-col gap-0.5"},ne={class:"font-medium"},de={class:"text-[10px] text-zinc-400"},ce={class:"grid grid-cols-2 gap-4"},ue={class:"space-y-1.5"},pe={class:"relative"},me={class:"space-y-1.5"},_e={class:"space-y-4"},ve={class:"flex items-center justify-between"},xe={class:"flex items-center gap-2"},fe={class:"grid grid-cols-2 gap-4"},ge={class:"space-y-1.5"},be={class:"space-y-1.5"},he={class:"text-[10px] lowercase text-zinc-400 font-normal"},ze={class:"h-11 flex items-center px-3 rounded-lg bg-emerald-50 border border-emerald-100 text-emerald-700 font-bold text-lg"},we={class:"grid grid-cols-2 gap-3 p-3 rounded-xl bg-zinc-50 border border-zinc-100"},ye={class:"space-y-1 border-r border-zinc-200 pr-3"},Fe={class:"flex items-center justify-between text-[10px]"},Ce={class:"text-zinc-400 font-medium"},Pe={class:"font-bold text-zinc-800"},$e={class:"space-y-1 pl-1"},ke={class:"flex items-center justify-between text-[10px]"},Se={class:"text-blue-400 font-medium"},Ne={class:"font-extrabold text-blue-700"},Ve={class:"grid grid-cols-2 gap-3"},je={class:"p-2.5 rounded-lg border border-orange-100 bg-orange-50/50 space-y-1"},Me={class:"flex items-center gap-1.5 text-orange-600"},Te={class:"text-[13px] font-bold text-orange-700"},Be={class:"p-2.5 rounded-lg border border-rose-100 bg-rose-50/50 space-y-1"},We={class:"flex items-center gap-1.5 text-rose-600"},Ie={class:"text-[13px] font-bold text-rose-700"},Ue={class:"px-5 py-4 bg-zinc-50 border-t border-zinc-100 flex items-center justify-between"},qe={class:"flex gap-2"},Ae=O({__name:"CalcPopover",props:{ingredient:{},totalMateriaPrima:{},totalWasteWeight:{},totalCalories:{},totalCost:{},totalfinalProduct:{}},emits:["calcMassiveProperties"],setup(S,{emit:N}){const x=S,V=N,s=d(x.ingredient),h=d(0),p=d(0),y=d(0),f=d(0),F=d(0),m=d(0),C=d(0),j=n=>{var _,v;const t=parseFloat(n.target.value)||0;f.value=p.value*t,s.value.gross_weight=t*1e3,parseFloat(s.value.amount);const u=parseFloat((_=s.value.originalValues)==null?void 0:_.waste)||0,i=parseFloat((v=s.value.originalValues)==null?void 0:v.calories)||0;s.value.solid_waste=s.value.gross_weight*u/100,m.value=s.value.gross_weight-s.value.solid_waste,s.value.calories=m.value*i/100,V("calcMassiveProperties",s.value.id,[s.value.gross_weight,s.value.solid_waste,s.value.calories,f.value,m.value,p.value])},M=n=>{var t;p.value=parseFloat((t=n.pivot)==null?void 0:t.cost_price)||0,y.value=p.value/1e3};return $(h,n=>{var u;const t=(u=s.value.providers)==null?void 0:u.find(i=>i.id===Number(n));t&&M(t)}),$(x,n=>{s.value.gross_weight_volume=(s.value.gross_weight/(n.totalMateriaPrima||1)*100).toFixed(2),s.value.waste_volume=(s.value.solid_waste/(n.totalWasteWeight||1)*100).toFixed(2),s.value.calories_volume=(s.value.calories/(n.totalCalories||1)*100).toFixed(2),F.value=f.value/(x.totalCost||1)*100,C.value=m.value/(x.totalfinalProduct||1)*100}),(n,t)=>(w(),k(o(W),null,{default:l(()=>[a(o(T),{"as-child":""},{default:l(()=>[a(o(g),{variant:"ghost",size:"icon",class:"h-8 w-8 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors"},{default:l(()=>[a(o(P),{class:"h-4 w-4 text-zinc-500 hover:text-primary transition-colors"})]),_:1})]),_:1}),a(o(B),{class:"w-[420px] p-0 overflow-hidden rounded-xl border-none shadow-2xl bg-white",side:"right","side-offset":12},{default:l(()=>{var u;return[e("div",ee,[e("div",te,[e("div",se,[a(o(P),{class:"h-5 w-5 text-blue-600"})]),e("div",null,[t[2]||(t[2]=e("h4",{class:"font-bold text-zinc-900"},"Ajustes de Ingrediente",-1)),e("p",oe,r(s.value.name),1)])])]),e("div",ae,[e("div",le,[e("div",ie,[a(o(H),{class:"h-4 w-4 text-zinc-400"}),t[3]||(t[3]=e("span",{class:"text-sm font-bold text-zinc-700 uppercase tracking-wider text-[11px]"},"Proveedor y Precios",-1))]),a(o(I),{"model-value":String(h.value),"onUpdate:modelValue":t[0]||(t[0]=i=>h.value=i)},{default:l(()=>[a(o(U),{class:"h-11 border-zinc-200 bg-zinc-50/30"},{default:l(()=>[a(o(q),{placeholder:"Seleccionar un proveedor"})]),_:1}),a(o(A),{class:"bg-white border-zinc-200"},{default:l(()=>[a(o(G),null,{default:l(()=>[(w(!0),Q(X,null,Y(s.value.providers,i=>(w(),k(o(D),{key:i.id,value:String(i.id),class:"py-2.5"},{default:l(()=>{var _,v;return[e("div",re,[e("span",ne,r(i.name),1),e("span",de,r(((v=(_=i.cities)==null?void 0:_[0])==null?void 0:v.name)||"N/A"),1)])]}),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1},8,["model-value"]),e("div",ce,[e("div",ue,[a(o(b),{class:"text-[11px] font-bold text-zinc-500 flex items-center gap-1.5 uppercase"},{default:l(()=>[a(o(J),{class:"h-3 w-3"}),t[4]||(t[4]=c(" Precio Unit. "))]),_:1}),e("div",pe,[a(o(z),{"model-value":`S/. ${Number(p.value).toFixed(2)}`,readonly:"",class:"h-10 bg-zinc-100/50 border-zinc-200 font-bold"},null,8,["model-value"])])]),e("div",me,[a(o(b),{class:"text-[11px] font-bold text-zinc-500 flex items-center gap-1.5 uppercase"},{default:l(()=>t[5]||(t[5]=[c(" Pr. x Gr. ")])),_:1}),a(o(z),{"model-value":`S/. ${Number(y.value).toFixed(4)}`,readonly:"",class:"h-10 bg-zinc-100/50 border-zinc-200 font-medium text-zinc-600"},null,8,["model-value"])])])]),a(o(E),{class:"bg-zinc-100"}),e("div",_e,[e("div",ve,[e("div",xe,[a(o(L),{class:"h-4 w-4 text-zinc-400"}),t[6]||(t[6]=e("span",{class:"text-sm font-bold text-zinc-700 uppercase tracking-wider text-[11px]"},"CÃ¡lculo de Insumo",-1))])]),e("div",fe,[e("div",ge,[a(o(b),{class:"text-[11px] font-bold text-zinc-500 uppercase"},{default:l(()=>t[7]||(t[7]=[c("Cantidad")])),_:1}),a(o(z),{modelValue:s.value.quantity,"onUpdate:modelValue":t[1]||(t[1]=i=>s.value.quantity=i),onInput:j,type:"number",step:"0.01",class:"h-11 border-zinc-200 focus:ring-2 focus:ring-blue-500 text-lg font-bold",placeholder:"0.00"},null,8,["modelValue"])]),e("div",be,[a(o(b),{class:"text-[11px] font-bold text-zinc-500 uppercase flex items-center justify-between"},{default:l(()=>[t[8]||(t[8]=c(" Costo Base ")),e("span",he,"("+r(Number(F.value).toFixed(1))+"%)",1)]),_:1}),e("div",ze," S/. "+r(Number(f.value).toFixed(2)),1)])]),e("div",we,[e("div",ye,[e("div",Fe,[t[9]||(t[9]=e("span",{class:"text-zinc-500 font-bold uppercase tracking-tighter"},"Mat. Prima",-1)),e("span",Ce,r(s.value.gross_weight_volume)+"%",1)]),e("div",Pe,r(s.value.gross_weight)+"g",1)]),e("div",$e,[e("div",ke,[t[10]||(t[10]=e("span",{class:"text-blue-600 font-bold uppercase tracking-tighter"},"Prod. Final",-1)),e("span",Se,r(Number(C.value).toFixed(1))+"%",1)]),e("div",Ne,r(Number(m.value).toFixed(2))+"g",1)])])]),e("div",Ve,[e("div",je,[e("div",Me,[a(o(K),{class:"h-3 w-3"}),t[11]||(t[11]=e("span",{class:"text-[9px] font-bold uppercase"},"Merma Tot.",-1))]),e("div",Te,r(Number(s.value.solid_waste).toFixed(2))+"g ("+r((u=s.value.originalValues)==null?void 0:u.waste)+"%)",1)]),e("div",Be,[e("div",We,[a(o(R),{class:"h-3 w-3"}),t[12]||(t[12]=e("span",{class:"text-[9px] font-bold uppercase"},"Calories",-1))]),e("div",Ie,[c(r(parseFloat(s.value.calories).toFixed(0))+" ",1),t[13]||(t[13]=e("span",{class:"text-[8px] font-normal"},"kcal",-1))])])])]),e("div",Ue,[a(o(g),{variant:"ghost",size:"sm",class:"text-zinc-500 font-bold text-[11px] uppercase tracking-wide px-0 hover:bg-transparent hover:text-zinc-800"},{default:l(()=>t[14]||(t[14]=[c(" Restablecer ")])),_:1}),e("div",qe,[a(o(g),{variant:"ghost",size:"sm",class:"h-8 rounded-lg text-zinc-500 font-medium"},{default:l(()=>t[15]||(t[15]=[c("Cerrar")])),_:1}),a(o(g),{size:"sm",class:"h-8 px-5 rounded-lg shadow-sm font-bold bg-zinc-900 hover:bg-zinc-800 text-[11px] uppercase tracking-wider"},{default:l(()=>t[16]||(t[16]=[c(" Aplicar ")])),_:1})])])]}),_:1})]),_:1}))}}),ft=Z(Ae,[["__scopeId","data-v-eba01f52"]]);export{ft as default};
