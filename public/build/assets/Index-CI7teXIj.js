import{_ as A}from"./AppLayout.vue_vue_type_script_setup_true_lang-Ps1PlFQz.js";import{d as K,r as w,C as W,s as Q,c as m,o as n,a as o,u as e,m as J,w as a,b as l,P as X,e as _,F as f,l as x,g as b,t as c,W as Z}from"./app-CkZEfMms.js";import{_ as S}from"./Card.vue_vue_type_script_setup_true_lang-BaU2CocA.js";import{_ as P}from"./CardContent.vue_vue_type_script_setup_true_lang-BmVcY8-Q.js";import{_ as E,a as G}from"./CardTitle.vue_vue_type_script_setup_true_lang-CTVOUjJ6.js";import{_ as C}from"./index-DfCtkBzz.js";import{_ as U,a as z,b as B,c as F,d as H}from"./SelectValue.vue_vue_type_script_setup_true_lang-DtD1ELjO.js";import{_ as I}from"./Input.vue_vue_type_script_setup_true_lang-BzXStTK3.js";import{e as ee,_ as te,a as j,b as N,c as se,d as Y}from"./TableHeader.vue_vue_type_script_setup_true_lang-fQ77Oeeo.js";import{r as ae,d as p}from"./dayjs.min-CpyQCa-6.js";import"./utils-bRKmu4jq.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-uDZIAxcv.js";import"./Presence-CSQnosAz.js";import"./Primitive-BaxYTMe3.js";import"./useForwardExpose-Dg33A9vK.js";import"./PopperContent-BGTebBo7.js";import"./Teleport-D3oEZkhi.js";import"./VisuallyHidden-BZmJHXuN.js";import"./index-dkW4UkYo.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DIc209wC.js";import"./utils-BES3iSsD.js";import"./useTypeahead-Qdx9aMH9.js";import"./RovingFocusGroup-D1FZjDRA.js";import"./usePrimitiveElement-B_8q4JJ0.js";import"./Collection-wDR0_nmv.js";import"./utensils-CdPC0c8Z.js";import"./createLucideIcon-Bo8ztqDM.js";import"./DialogTitle-DcdfjZkw.js";import"./x-B92Fb9I8.js";import"./DialogDescription-DoXSrK36.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./hand-helping-Dpc7uywk.js";import"./building-2-DqusJzvr.js";import"./user-CNvsYSp_.js";import"./chevron-right-CtiWMolp.js";import"./chevron-down-DKw0lhjU.js";import"./chevron-up-Deixdta0.js";import"./check-DkZocY_5.js";import"./useFormControl-CyRv7QWe.js";var D={exports:{}},oe=D.exports,O;function le(){return O||(O=1,function(k,V){(function(h,$){k.exports=$(ae())})(oe,function(h){function $(d){return d&&typeof d=="object"&&"default"in d?d:{default:d}}var v=$(h),g={name:"es",monthsShort:"ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),weekdays:"domingo_lunes_martes_miércoles_jueves_viernes_sábado".split("_"),weekdaysShort:"dom._lun._mar._mié._jue._vie._sáb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_sá".split("_"),months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),weekStart:1,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un día",dd:"%d días",M:"un mes",MM:"%d meses",y:"un año",yy:"%d años"},ordinal:function(d){return d+"º"}};return v.default.locale(g,null,!0),g})}(D)),D.exports}le();const re={class:"flex flex-col gap-6 p-6"},de={class:"flex items-center justify-between"},ne={class:"grid grid-cols-1 gap-6 md:grid-cols-3"},ie={class:"flex flex-col gap-2"},ue={class:"flex flex-col gap-2"},me={class:"flex items-end"},_e={class:"overflow-x-auto rounded-2xl border bg-card shadow-sm"},fe={class:"capitalize"},ce={class:"text-xs text-muted-foreground"},pe={class:"flex flex-col gap-1"},ge={class:"mt-8"},xe={class:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3"},ve={class:"flex flex-col gap-2 text-sm"},ye={class:"flex justify-between"},be={class:"flex justify-between"},$e={class:"capitalize"},dt=K({__name:"Index",props:{cafes:{},programs:{},dish_categories:{},menu_structure:{},dishes:{}},setup(k){p.locale("es");const V=k,h=["Desayuno","Almuerzo","Cena","Refrigerio"],$=w(p().startOf("week").add(1,"day").format("YYYY-MM-DD")),v=w({}),g=w({}),d=W({cafe_id:"",start_date:$.value,end_date:p($.value).add(6,"days").format("YYYY-MM-DD"),items:[],portions:[]}),M=Q(()=>Array.from({length:7},(i,t)=>p(d.start_date).add(t,"days").format("YYYY-MM-DD"))),L=()=>{v.value={},g.value={},M.value.forEach(i=>{h.forEach(t=>{const s=`${i}_${t}`;v.value[s]=0,V.menu_structure.filter(u=>u.meal_type===t).forEach(u=>{const y=`${i}_${t}_${u.dish_category_id}`;g.value[y]=""})})})},T=()=>{d.end_date=p(d.start_date).add(6,"days").format("YYYY-MM-DD"),L()};L();const q=()=>{d.portions=[],d.items=[];for(const[i,t]of Object.entries(v.value)){const[s,r]=i.split("_");d.portions.push({date:s,meal_type:r,portions_count:t})}for(const[i,t]of Object.entries(g.value)){const[s,r,u]=i.split("_");d.items.push({date:s,meal_type:r,dish_category_id:parseInt(u),dish_id:t||null})}d.post(route("planning.store"))},R=i=>V.dishes.filter(t=>{var s;return(s=t.dish_categories)==null?void 0:s.some(r=>r.id===i)});return(i,t)=>(n(),m(f,null,[o(e(J),{title:"Planificación Semanal"}),o(A,null,{default:a(()=>[l("div",re,[l("div",de,[t[3]||(t[3]=l("h1",{class:"text-2xl font-bold"},"Planificación Semanal",-1)),o(e(X),{href:i.route("purchase_orders.index")},{default:a(()=>[o(e(C),{variant:"outline",class:"rounded-xl"},{default:a(()=>t[2]||(t[2]=[_("Ver Órdenes de Compra")])),_:1})]),_:1},8,["href"])]),o(e(S),{class:"rounded-2xl border-none shadow-sm"},{default:a(()=>[o(e(E),null,{default:a(()=>[o(e(G),null,{default:a(()=>t[4]||(t[4]=[_("Nueva Programación")])),_:1})]),_:1}),o(e(P),null,{default:a(()=>[l("div",ne,[l("div",ie,[t[5]||(t[5]=l("label",{class:"text-sm font-medium"},"Café / Comedor",-1)),o(e(U),{modelValue:e(d).cafe_id,"onUpdate:modelValue":t[0]||(t[0]=s=>e(d).cafe_id=s)},{default:a(()=>[o(e(z),{class:"rounded-xl"},{default:a(()=>[o(e(B),{placeholder:"Seleccionar Café"})]),_:1}),o(e(F),null,{default:a(()=>[(n(!0),m(f,null,x(i.cafes,s=>(n(),b(e(H),{key:s.id,value:s.id.toString()},{default:a(()=>[_(c(s.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),l("div",ue,[t[6]||(t[6]=l("label",{class:"text-sm font-medium"},"Fecha de Inicio",-1)),o(e(I),{type:"date",modelValue:e(d).start_date,"onUpdate:modelValue":t[1]||(t[1]=s=>e(d).start_date=s),onChange:T,class:"rounded-xl"},null,8,["modelValue"])]),l("div",me,[o(e(C),{onClick:q,disabled:e(d).processing,class:"w-full rounded-xl bg-primary text-primary-foreground"},{default:a(()=>t[7]||(t[7]=[_(" Guardar Planificación ")])),_:1},8,["disabled"])])])]),_:1})]),_:1}),l("div",_e,[o(e(ee),null,{default:a(()=>[o(e(te),null,{default:a(()=>[o(e(j),null,{default:a(()=>[o(e(N),{class:"w-[150px]"},{default:a(()=>t[8]||(t[8]=[_("Comida / Día")])),_:1}),(n(!0),m(f,null,x(M.value,s=>(n(),b(e(N),{key:s,class:"text-center"},{default:a(()=>[l("div",fe,c(e(p)(s).format("dddd")),1),l("div",ce,c(e(p)(s).format("DD/MM")),1)]),_:2},1024))),128))]),_:1})]),_:1}),o(e(se),null,{default:a(()=>[(n(),m(f,null,x(h,s=>(n(),m(f,{key:s},[o(e(j),{class:"bg-muted/30"},{default:a(()=>[o(e(Y),{class:"font-bold underline"},{default:a(()=>[_(c(s),1)]),_:2},1024),(n(!0),m(f,null,x(M.value,r=>(n(),b(e(Y),{key:r},{default:a(()=>[l("div",pe,[t[9]||(t[9]=l("label",{class:"text-[10px] uppercase text-muted-foreground"},"Raciones",-1)),o(e(I),{type:"number",modelValue:v.value[`${r}_${s}`],"onUpdate:modelValue":u=>v.value[`${r}_${s}`]=u,class:"h-8 rounded-lg text-center"},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1024))),128))]),_:2},1024),(n(!0),m(f,null,x(i.menu_structure.filter(r=>r.meal_type===s),r=>(n(),b(e(j),{key:r.id},{default:a(()=>[o(e(Y),{class:"pl-6 text-sm italic text-muted-foreground"},{default:a(()=>{var u;return[_(c(((u=r.dish_category)==null?void 0:u.name)||"Categoría"),1)]}),_:2},1024),(n(!0),m(f,null,x(M.value,u=>(n(),b(e(Y),{key:u},{default:a(()=>[o(e(U),{modelValue:g.value[`${u}_${s}_${r.dish_category_id}`],"onUpdate:modelValue":y=>g.value[`${u}_${s}_${r.dish_category_id}`]=y},{default:a(()=>[o(e(z),{class:"h-9 rounded-xl text-xs"},{default:a(()=>[o(e(B),{placeholder:"Elegir plato"})]),_:1}),o(e(F),null,{default:a(()=>[(n(!0),m(f,null,x(R(r.dish_category_id),y=>(n(),b(e(H),{key:y.id,value:y.id.toString()},{default:a(()=>[_(c(y.name),1)]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024))),128))]),_:2},1024))),128))],64))),64))]),_:1})]),_:1})]),l("div",ge,[t[13]||(t[13]=l("h2",{class:"mb-4 text-xl font-bold"},"Programaciones Guardadas",-1)),l("div",xe,[(n(!0),m(f,null,x(i.programs,s=>(n(),b(e(S),{key:s.id,class:"rounded-2xl border-none shadow-sm"},{default:a(()=>[o(e(E),null,{default:a(()=>[o(e(G),{class:"text-lg"},{default:a(()=>{var r;return[_(c((r=s.cafe)==null?void 0:r.name),1)]}),_:2},1024)]),_:2},1024),o(e(P),null,{default:a(()=>[l("div",ve,[l("div",ye,[t[10]||(t[10]=l("span",{class:"text-muted-foreground"},"Periodo:",-1)),l("span",null,c(e(p)(s.start_date).format("DD/MM"))+" - "+c(e(p)(s.end_date).format("DD/MM")),1)]),l("div",be,[t[11]||(t[11]=l("span",{class:"text-muted-foreground"},"Estado:",-1)),l("span",$e,c(s.status),1)]),o(e(C),{onClick:r=>e(Z).post(i.route("planning.generate-po",s.id)),class:"mt-4 rounded-xl",variant:"secondary"},{default:a(()=>t[12]||(t[12]=[_(" Generar Quebrado (PO) ")])),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))])])])]),_:1})],64))}});export{dt as default};
